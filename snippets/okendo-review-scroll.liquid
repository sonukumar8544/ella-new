<script>
  // Okendo review scroll functionality
  document.addEventListener('DOMContentLoaded', function() {
    function scrollToReviewSection() {
      const reviewSection = document.getElementById('product-review-sections');
      if (reviewSection) {
        // Get sticky header height from CSS variable or calculate it
        let headerHeight = 0;
        
        // First, try to get header height from CSS variable (most accurate)
        const cssHeaderHeight = getComputedStyle(document.documentElement)
          .getPropertyValue('--header-height');
        if (cssHeaderHeight && cssHeaderHeight.trim() !== '') {
          headerHeight = parseInt(cssHeaderHeight) || 0;
        } else {
          // Fallback: get header height directly from element
          const headerElement = document.querySelector('.section-header-navigation');
          if (headerElement) {
            headerHeight = headerElement.offsetHeight || 0;
          }
        }
        
        // Add extra padding for better spacing (optional, can be adjusted)
        const extraPadding = 0;
        headerHeight = headerHeight + extraPadding;
        
        // Calculate scroll position with offset
        const elementPosition = reviewSection.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerHeight;
        
        // Smooth scroll with offset
        window.scrollTo({
          top: offsetPosition,
          behavior: 'smooth'
        });
      }
    }

    // Function to style Okendo review product element
    function styleOkendoProductElement() {
      const productElement = document.querySelector('[data-oke-reviews-product-id="shopify-8816697737512"]');
      if (productElement) {
        productElement.style.maxWidth = '140px';
        productElement.style.borderBottom = '2px solid red';
      }
    }

    // Function to add review text child element
    function addReviewTextChild() {
      // Try multiple methods to find the parent block
      let parentBlock = null;
      
      // Method 1: Try the specific block ID (for backward compatibility)
      parentBlock = document.getElementById('shopify-block-AKzR2MmJzOWYyanVMb__okendo_star_rating_APJhrn');
      
      // Method 2: Find parent block by looking for Okendo star rating element and traversing up
      if (!parentBlock) {
        const okendoRatingElement = document.querySelector('[data-oke-star-rating]');
        if (okendoRatingElement) {
          // Traverse up to find the Shopify block container
          let currentElement = okendoRatingElement.parentElement;
          while (currentElement && !parentBlock) {
            // Check if this is a Shopify block (usually has id starting with 'shopify-block-')
            if (currentElement.id && currentElement.id.startsWith('shopify-block-')) {
              parentBlock = currentElement;
              break;
            }
            // Also check for common Shopify section/block containers
            if (currentElement.classList.contains('shopify-section') || 
                currentElement.hasAttribute('data-section-id') ||
                currentElement.classList.contains('block')) {
              parentBlock = currentElement;
              break;
            }
            currentElement = currentElement.parentElement;
          }
          // If no block found, use the direct parent
          if (!parentBlock && okendoRatingElement.parentElement) {
            parentBlock = okendoRatingElement.parentElement;
          }
        }
      }
      
      // Method 3: Find by Okendo classes
      if (!parentBlock) {
        const okendoElement = document.querySelector('.oke-sr-rating, .oke-sr-stars, .oke-sr-count');
        if (okendoElement) {
          let currentElement = okendoElement.parentElement;
          while (currentElement && !parentBlock) {
            if (currentElement.id && currentElement.id.startsWith('shopify-block-')) {
              parentBlock = currentElement;
              break;
            }
            if (currentElement.classList.contains('shopify-section') || 
                currentElement.hasAttribute('data-section-id')) {
              parentBlock = currentElement;
              break;
            }
            currentElement = currentElement.parentElement;
          }
          if (!parentBlock && okendoElement.parentElement) {
            parentBlock = okendoElement.parentElement;
          }
        }
      }
      
      if (parentBlock) {
        // Set parent to display flex with gap and alignment
        parentBlock.style.display = 'flex';
        parentBlock.style.gap = '12px';
        parentBlock.style.alignItems = 'center';
        // parentBlock.style.flexWrap = 'nowrap';
        
        // Set first child max-width to 150px
        const firstChild = parentBlock.firstElementChild;
        if (firstChild) {
          firstChild.style.maxWidth = '200px';
          firstChild.style.flexShrink = '0';
          // firstChild.style.borderBottom = '1px solid #086b92';
        }
        
        // Check if child already exists to avoid duplicates
        const existingChild = parentBlock.querySelector('.okendo-review-text-child');
        if (!existingChild) {
          const reviewTextChild = document.createElement('div');
          reviewTextChild.className = 'okendo-review-text-child';
          reviewTextChild.textContent = '8500+ Reviews on marketplaces';
          reviewTextChild.style.flexShrink = '0';
          reviewTextChild.style.whiteSpace = 'nowrap';
          parentBlock.appendChild(reviewTextChild);
        } else {
          // Update existing child styles
          existingChild.style.flexShrink = '0';
          existingChild.style.whiteSpace = 'nowrap';
        }
      }
    }

    // Function to attach click listeners to Okendo review elements
    function attachOkendoClickListeners() {
      // Select all Okendo review elements that should trigger scroll
      const okendoElements = document.querySelectorAll(
        '[data-oke-star-rating], .oke-sr-rating, .oke-sr-stars, .oke-sr-count, .oke-stars, .oke-sr'
      );

      okendoElements.forEach(function(element) {
        // Remove existing listener to avoid duplicates
        element.removeEventListener('click', scrollToReviewSection);
        // Add click listener
        element.addEventListener('click', function(e) {
          e.preventDefault();
          scrollToReviewSection();
        });
        
        // Make cursor pointer to indicate clickable
        element.style.cursor = 'pointer';
      });
    }

    // Function to run all Okendo modifications
    function applyOkendoModifications() {
      attachOkendoClickListeners();
      styleOkendoProductElement();
      addReviewTextChild();
    }

    // Initial attachment
    applyOkendoModifications();

    // Re-attach listeners after Okendo content loads (in case it loads dynamically)
    const observer = new MutationObserver(function(mutations) {
      applyOkendoModifications();
    });

    // Observe changes in the document body
    observer.observe(document.body, {
      childList: true,
      subtree: true
    });

    // Also try after delays to catch late-loading content (Okendo can load asynchronously)
    setTimeout(applyOkendoModifications, 1000);
    setTimeout(applyOkendoModifications, 3000);
    setTimeout(applyOkendoModifications, 5000);
    setTimeout(applyOkendoModifications, 8000);
  });
</script>

<style>
  @media (min-width: 1025px) {
    .okendo-review-text-child {
      padding-left: 40px;
      padding-bottom: 6px;
    }
  }
 
  span.oke-sr-count-number {
    border-bottom: 1px solid black;
  }

  @media (max-width: 1024px) {
    /* Target any Shopify block containing Okendo elements */
    #shopify-block-AKzR2MmJzOWYyanVMb__okendo_star_rating_APJhrn,
    [id^="shopify-block-"][id*="okendo"],
    /* Also target parent elements that contain Okendo star rating */
    :has([data-oke-star-rating]) {
      flex-direction: column;
      flex-wrap: wrap !important;
      gap: 0px !important;
      align-items: flex-start !important;
    }
  }
</style>

